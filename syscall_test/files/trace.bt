// -------------read---------------------
tracepoint:syscalls:sys_enter_read /comm=="threshold"/ 
{ 
    @read_buf[tid] = args->buf;
    @read_count[tid] = args->count;
} 
tracepoint:syscalls:sys_exit_read /comm=="threshold"/
{
    printf("read %s", str(@read_buf[tid], @read_count[tid]));
    clear(@read_buf);
    clear(@read_count);
}
    
//-------------pread64------------------
tracepoint:syscalls:sys_enter_pread64 /comm=="threshold"/ 
{
    @pread64_buf[tid] = args->buf;
    @pread64_count[tid] = args->count;
}
tracepoint:syscalls:sys_exit_pread64 /comm=="threshold"/ 
{
    printf("pread64 %s", str(@pread64_buf[tid], @pread64_count[tid]));
    clear(@pread64_buf);
    clear(@pread64_count);
}

//--------------readv-------------------
tracepoint:syscalls:sys_enter_readv /comm=="threshold"/ 
{ 
    @readv_buf[tid] = (args->vec)->iov_base;
    @readv_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_readv /comm=="threshold"/
{
    printf("readv %s", str(@readv_buf[tid], @readv_count[tid]));
    clear(@readv_buf);
    clear(@readv_count);
}

//-------------preadv-------------------
tracepoint:syscalls:sys_enter_preadv /comm=="threshold"/ 
{
    @preadv_buf[tid] = (args->vec)->iov_base;
    @preadv_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_preadv /comm=="threshold"/
{
    printf("preadv %s", str(@preadv_buf[tid], @preadv_count[tid]));
    clear(@preadv_buf);
    clear(@preadv_count);
} 

//--------------write-------------------
tracepoint:syscalls:sys_enter_write /comm=="threshold"/ 
{
    @write_buf[tid] = args->buf;
    @write_count[tid] = args->count;
}
tracepoint:syscalls:sys_exit_write /comm=="threshold"/
{
    printf("write %s", str(@write_buf[tid], @write_count[tid]));
    clear(@write_buf);
    clear(@write_count);
}

//---------------pwrite64-----------------
tracepoint:syscalls:sys_enter_pwrite64 /comm=="threshold"/ 
{ 
    @pwrite64_buf[tid] = args->buf;
    @pwrite64_count[tid] = args->count;
}
tracepoint:syscalls:sys_exit_pwrite64 /comm=="threshold"/
{
    printf("pwrite %s", str(@pwrite64_buf[tid], @pwrite64_count[tid]));
    clear(@pwrite64_buf);
    clear(@pwrite64_count);
}

//---------------pwritev-----------------
tracepoint:syscalls:sys_enter_pwritev /comm=="threshold"/ 
{ 
    @pwritev_buf[tid] = (args->vec)->iov_base;
    @pwritev_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_pwritev /comm=="threshold"/ 
{
    printf("pwritev %s", str(@pwritev_buf[tid], @pwritev_count[tid]));
    clear(@pwritev_buf);
    clear(@pwritev_count);
}

//----------------writev-----------------
tracepoint:syscalls:sys_enter_writev /comm=="threshold"/ 
{
    @writev_buf[tid] = (args->vec)->iov_base;
    @writev_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_writev /comm=="threshold"/ 
{
    printf("writev %s", str(@writev_buf[tid], @writev_count[tid]));
    clear(@writev_buf);
    clear(@writev_count);
}

//----------------pwritev2--------------
tracepoint:syscalls:sys_enter_pwritev2 /comm=="threshold"/ 
{
    @pwritev2_buf[tid] = (args->vec)->iov_base;
    @pwritev2_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_pwritev2 /comm=="threshold"/ 
{
    printf("pwritev2 %s", str(@pwritev2_buf[tid], @pwritev2_count[tid]));
    clear(@pwritev2_buf);
    clear(@pwritev2_count);
}

//---------------recvfrom------------------
tracepoint:syscalls:sys_enter_recvfrom /comm=="threshold"/
{
    @recvfrom_buf[tid] = args->ubuf;
    @recvfrom_count[tid] = args->size;
}
tracepoint:syscalls:sys_exit_recvfrom /comm=="threshold"/
{
    printf("recvfrom %s", str(@recvfrom_buf[tid], @recvfrom_count[tid]));
    clear(@recvfrom_buf);
    clear(@recvfrom_count);
}

//----------------recvmsg--------------
tracepoint:syscalls:sys_enter_recvmsg /comm=="threshold"/
{
    @recvmsg_buf[tid] = (args->msg)->msg_iov;
    @recvmsg_count[tid] = (args->msg)->msg_iovlen;
}
tracepoint:syscalls:sys_exit_recvmsg /comm=="threshold"/
{
    printf("recvmsg %s", str(@recvmsg_buf[tid], @recvmsg_count[tid]));
    clear(@recvmsg_buf);
    clear(@recvmsg_count);
}

//----------------mq_timedreceive-----------
tracepoint:syscalls:sys_enter_mq_timedreceive /comm=="threshold"/
{
    @mq_timedreceive_buf[tid] = args->u_msg_ptr;
    @mq_timedreceive_count[tid] = args->msg_len;
}
tracepoint:syscalls:sys_exit_mq_timedreceive /comm=="threshold"/
{
    printf("mq_timedreceive %s", str(@mq_timedreceive_buf[tid], @mq_timedreceive_count[tid]));
    clear(@mq_timedreceive_buf);
    clear(@mq_timedreceive_count);
}

//-----------------readlink------------------
tracepoint:syscalls:sys_enter_readlink /comm=="threshold"/
{
    @readlink_buf[tid] = args->buf;
    @readlink_count[tid] = args->bufsiz;
}
tracepoint:syscalls:sys_exit_readlink /comm=="threshold"/
{
    printf("readlink %s", str(@readlink_buf[tid], @readlink_count[tid]));
    clear(@readlink_buf);
    clear(@readlink_count);
}

//----------------readlinkat-----------------
tracepoint:syscalls:sys_enter_readlinkat /comm=="threshold"/
{
    @readlinkat_buf[tid] = args->buf;
    @readlinkat_count[tid] = args->bufsiz;
}
tracepoint:syscalls:sys_exit_readlinkat /comm=="threshold"/
{
    printf("readlinkat %s", str(@readlinkat_buf[tid], @readlinkat_count[tid]));
    clear(@readlinkat_buf);
    clear(@readlinkat_count);
}

//---------------sendto----------------------
tracepoint:syscalls:sys_enter_sendto /comm=="threshold"/
{
    @sendto_buf[tid] = args->buff;
    @sendto_count[tid] = args->len;
}
tracepoint:syscalls:sys_exit_sendto /comm=="threshold"/
{
    printf("sendto %s", str(@sendto_buf[tid], @sendto_count[tid]));
    clear(@sendto_buf);
    clear(@sendto_count);
}

//-------------sendmsg----------------------
tracepoint:syscalls:sys_enter_sendmsg /comm=="threshold"/
{
    @sendmsg_buf[tid] = ((args->msg)->msg_iov)->iov_base;
    @sendmsg_count[tid] = (args->msg)->msg_iovlen;
}
tracepoint:syscalls:sys_exit_sendmsg /comm=="threshold"/
{
    printf("sendmsg %s", str(@sendmsg_buf[tid], @sendmsg_count[tid]));
    clear(@sendmsg_buf);
    clear(@sendmsg_count);
}