// -------------read---------------------
tracepoint:syscalls:sys_enter_read /comm=="file_sys"/ 
{ 
    @read_buf[tid] = args->buf;
    @read_count[tid] = args->count;
} 
tracepoint:syscalls:sys_exit_read /comm=="file_sys"/
{
    printf("read %s", str(@read_buf[tid], @read_count[tid]));
    clear(@read_buf);
    clear(@read_count);
}
    
//-------------pread64------------------
tracepoint:syscalls:sys_enter_pread64 /comm=="file_sys"/ 
{
    @pread64_buf[tid] = args->buf;
    @pread64_count[tid] = args->count;
}
tracepoint:syscalls:sys_exit_pread64 /comm=="file_sys"/ 
{
    printf("pread64 %s", str(@pread64_buf[tid], @pread64_count[tid]));
    clear(@pread64_buf);
    clear(@pread64_count);
}

//--------------readv-------------------
tracepoint:syscalls:sys_enter_readv /comm=="file_sys"/ 
{ 
    @readv_buf[tid] = (args->vec)->iov_base;
    @readv_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_readv /comm=="file_sys"/
{
    printf("readv %s", str(@readv_buf[tid], @readv_count[tid]));
    clear(@readv_buf);
    clear(@readv_count);
}

//-------------preadv-------------------
tracepoint:syscalls:sys_enter_preadv /comm=="file_sys"/ 
{
    @preadv_buf[tid] = (args->vec)->iov_base;
    @preadv_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_preadv /comm=="file_sys"/
{
    printf("preadv %s", str(@preadv_buf[tid], @preadv_count[tid]));
    clear(@preadv_buf);
    clear(@preadv_count);
} 

//--------------write-------------------
tracepoint:syscalls:sys_enter_write /comm=="file_sys"/ 
{
    @write_buf[tid] = args->buf;
    @write_count[tid] = args->count;
}
tracepoint:syscalls:sys_exit_write /comm=="file_sys"/
{
    printf("write %s", str(@write_buf[tid], @write_count[tid]));
    clear(@write_buf);
    clear(@write_count);
}

//---------------pwrite64-----------------
tracepoint:syscalls:sys_enter_pwrite64 /comm=="file_sys"/ 
{ 
    @pwrite64_buf[tid] = args->buf;
    @pwrite64_count[tid] = args->count;
}
tracepoint:syscalls:sys_exit_pwrite64 /comm=="file_sys"/
{
    printf("pwrite %s", str(@pwrite64_buf[tid], @pwrite64_count[tid]));
    clear(@pwrite64_buf);
    clear(@pwrite64_count);
}

//---------------pwritev-----------------
tracepoint:syscalls:sys_enter_pwritev /comm=="file_sys"/ 
{ 
    @pwritev_buf[tid] = (args->vec)->iov_base;
    @pwritev_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_pwritev /comm=="file_sys"/ 
{
    printf("pwritev %s", str(@pwritev_buf[tid], @pwritev_count[tid]));
    clear(@pwritev_buf);
    clear(@pwritev_count);
}

//----------------writev-----------------
tracepoint:syscalls:sys_enter_writev /comm=="file_sys"/ 
{
    @writev_buf[tid] = (args->vec)->iov_base;
    @writev_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_writev /comm=="file_sys"/ 
{
    printf("writev %s", str(@writev_buf[tid], @writev_count[tid]));
    clear(@writev_buf);
    clear(@writev_count);
}

//----------------pwritev2--------------
tracepoint:syscalls:sys_enter_pwritev2 /comm=="file_sys"/ 
{
    @pwritev2_buf[tid] = (args->vec)->iov_base;
    @pwritev2_count[tid] = (args->vec)->iov_len;
}
tracepoint:syscalls:sys_exit_pwritev2 /comm=="file_sys"/ 
{
    printf("pwritev2 %s", str(@pwritev2_buf[tid], @pwritev2_count[tid]));
    clear(@pwritev2_buf);
    clear(@pwritev2_count);
}
